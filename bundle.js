(()=>{"use strict";var t,e,i;!function(t){t.ClickMultiplier="clickMultiplier",t.ButtonSpeed="buttonSpeed",t.AutoClicker="autoClicker",t.MultiButton="multiButton",t.ButtonModifierConfig="buttonModifierConfig"}(t||(t={})),function(t){t.Normal="normal",t.Golden="golden",t.Frozen="frozen"}(e||(e={})),function(t){t.None="none",t.Bouncy="bouncy",t.Hyperactive="hyperactive",t.Shrinking="shrinking",t.ZigZag="zigzag"}(i||(i={}));class o{static initializeUpgrades(){const t={};return this.INITIAL_UPGRADES.forEach((e=>{t[e.id]={...e}})),t}static canPurchaseUpgrade(t,e){const i=t.upgrades[e];return!!i&&t.points>=i.cost&&i.level<i.maxLevel}static purchaseUpgrade(e,i){const o=e.upgrades[i];if(!this.canPurchaseUpgrade(e,i))return e;const n={...e};n.points-=o.cost;const s={...o};switch(s.level+=1,s.cost=Math.floor(o.cost*o.costMultiplier),s.purchased=!0,o.type){case t.ClickMultiplier:n.clickMultiplier=Math.pow(2,s.level);break;case t.ButtonSpeed:n.buttonSpeed=1+s.level*s.baseEffect;break;case t.AutoClicker:n.autoClickerRate=s.level*s.baseEffect;break;case t.MultiButton:n.multiButtonCount=(n.multiButtonCount||1)+1}return n.upgrades[i]=s,n}static getUpgradeEffect(e){switch(e.type){case t.ClickMultiplier:return`${Math.pow(2,e.level)}x → ${Math.pow(2,e.level+1)}x CP per click`;case t.ButtonSpeed:const i=1+e.level*e.baseEffect,o=1+(e.level+1)*e.baseEffect;return`${(100*i).toFixed(0)}% → ${(100*o).toFixed(0)}% speed`;case t.AutoClicker:return e.level*e.baseEffect+" CP/s";case t.MultiButton:return`${e.level+1} buttons on screen`;default:return""}}}o.INITIAL_UPGRADES=[{id:"click-power",name:"Click Power",description:"Double your CP per click",cost:10,level:0,maxLevel:10,baseEffect:1,costMultiplier:2,type:t.ClickMultiplier,purchased:!1},{id:"button-speed",name:"Button Speed",description:"Make the button move faster",cost:15,level:0,maxLevel:5,baseEffect:.5,costMultiplier:2.5,type:t.ButtonSpeed,purchased:!1},{id:"auto-clicker",name:"Auto-Clicker",description:"Activate a Windows mouse that clicks for you",cost:50,level:0,maxLevel:10,baseEffect:1,costMultiplier:2.5,type:t.AutoClicker,purchased:!1},{id:"multi-button",name:"Multi Button",description:"Unlocks and adds another clickable button on screen",cost:50,level:0,maxLevel:5,baseEffect:1,costMultiplier:3,type:t.MultiButton,purchased:!1},{id:"button-modifier-config",name:"Modifier Config",description:"Unlocks the ability to configure modifiers for your buttons",cost:100,level:0,maxLevel:1,baseEffect:1,costMultiplier:1,type:t.ButtonModifierConfig,purchased:!1}];class n{constructor(){if(this.autoClickerMouseEl=null,this.autoClickerActive=!1,this.autoClickerInterval=null,this.bouncingButtons=new Map,this.state={points:0,clickMultiplier:1,autoClickerRate:0,buttonSpeed:1,upgrades:o.initializeUpgrades(),multiButtonCount:1,buttonSlots:[]},this.buttons=new Map,this.container=document.getElementById("game-container"),this.pointsCounter=document.getElementById("points-counter"),this.upgradesContainer=document.getElementById("upgrades"),!this.container||!this.pointsCounter||!this.upgradesContainer)throw new Error("Required DOM elements not found");this.updateDisplay(),this.init()}init(){this.loadGame(),this.renderButtons(),this.setupAutoSave(),this.renderUpgrades(),this.checkAutoClickerActivation(),this.setupDeleteSaveButton(),this.setupButtonSlotConfigUI()}renderButtons(){for(const t of Array.from(this.buttons.keys()))this.removeButton(t);const t=this.state.multiButtonCount||1;for(let o=0;o<t;o++){const t=this.state.buttonSlots?.[o],n={position:this.getRandomPosition(),size:60,speed:this.state.buttonSpeed,variant:t?.variant??e.Normal,modifiers:t?.modifiers??(0===o?[i.None]:[])};this.createButton(`multi-${o}-${Date.now()}`,n)}}createButton(t,o){t.startsWith("multi-0-")?o.modifiers=[i.None]:this.maybeAddModifier(o);const n=document.createElement("button");n.className="moving-button",n.textContent=this.getButtonLabel(o.variant,o.modifiers),n.dataset.id=t,n.style.position="absolute",n.style.width=`${o.size}px`,n.style.height=`${o.size}px`,n.style.left=`${o.position.x}px`,n.style.top=`${o.position.y}px`,n.style.zIndex="90",n.style.pointerEvents="auto",o.variant&&o.variant!==e.Normal&&n.classList.add(`variant-${o.variant}`);for(const t of o.modifiers)t!==i.None&&n.classList.add(`modifier-${t}`);n.addEventListener("click",(()=>this.handleButtonClick(t))),this.container.appendChild(n),this.buttons.set(t,o),this.applyModifierEffects(n,o,t)}handleButtonClick(t){const i=this.buttons.get(t);if(!i)return;let o=Math.floor(this.state.clickMultiplier),n=!1;i.variant===e.Golden?(o*=5,n=!0,this.createExplosionEffect(t,"golden")):i.variant===e.Frozen&&(o+=10,n=!0,this.createExplosionEffect(t,"frozen")),this.addPoints(o);const s=this.getRandomPosition(),a=this.container.querySelector(`button[data-id="${t}"]`);if(a){a.style.left=`${s.x}px`,a.style.top=`${s.y}px`,i.position=s;const t=Math.max(.1,Math.min(2,this.state.buttonSpeed));a.style.transition=`left ${.3/t}s ease, top ${.3/t}s ease`}this.createPointsPopup(i.position,o),this.saveGame(),this.maybeSpawnVariant(),n&&this.removeButton(t)}removeButton(t){const e=this.container.querySelector(`button[data-id="${t}"]`);e&&e.remove(),this.buttons.delete(t)}maybeSpawnVariant(){if([...this.buttons.values()].some((t=>t.variant&&t.variant!==e.Normal)))return;const t=Math.random();t<.02?this.spawnButtonVariant(e.Golden):t<.04&&this.spawnButtonVariant(e.Frozen)}spawnButtonVariant(t){const e={position:this.getRandomPosition(),size:60,speed:this.state.buttonSpeed,variant:t,modifiers:[]};this.createButton(`${t}-${Date.now()}`,e)}getButtonLabel(t,o){let n="";switch(t){case e.Golden:n="🟡 Golden!";break;case e.Frozen:n="❄️ Frozen!";break;default:n="Click!"}return o&&o[0]!==i.None&&(n+=" "+o.map((t=>this.getModifierIcon(t))).join(" ")),n}getModifierIcon(t){switch(t){case i.Bouncy:return"🟠";case i.Hyperactive:return"💨";case i.Shrinking:return"🔽";case i.ZigZag:return"🟣";default:return""}}applyModifierEffects(t,e,o){for(const n of e.modifiers)switch(n){case i.Bouncy:t.style.animation="bouncyMove 0.8s infinite cubic-bezier(.68,-0.55,.27,1.55)";break;case i.Hyperactive:t.style.transition="left 0.08s linear, top 0.08s linear";break;case i.Shrinking:t.style.transform="scale(0.8)";break;case i.ZigZag:this.startBouncingButton(o,t,e)}}maybeAddModifier(t){if(t.modifiers.length>0&&(t.modifiers.length>1||void 0!==t.modifiers[0]&&t.modifiers[0]!==i.None))return;const e=Math.random();t.modifiers=e<.1?[i.Bouncy]:e<.18?[i.Hyperactive]:e<.22?[i.Shrinking]:e<.27?[i.ZigZag]:[i.None]}startBouncingButton(t,e,i){const o=2*i.speed+Math.random();let n=(Math.random()>.5?1:-1)*o,s=(Math.random()>.5?1:-1)*o;this.bouncingButtons.set(t,{vx:n,vy:s});const a=()=>{if(!this.buttons.has(t))return void this.bouncingButtons.delete(t);let o=this.buttons.get(t).position,r=o.x+n,l=o.y+s;const c=i.size,u=window.innerWidth-c-340,d=window.innerHeight-c;r<0&&(r=0,n=-n),r>u&&(r=u,n=-n),l<0&&(l=0,s=-s),l>d&&(l=d,s=-s),e.style.left=`${r}px`,e.style.top=`${l}px`,this.buttons.get(t).position={x:r,y:l},this.bouncingButtons.set(t,{vx:n,vy:s}),requestAnimationFrame(a)};a()}renderUpgrades(){this.upgradesContainer.innerHTML="<h2>Upgrades</h2>",Object.values(this.state.upgrades).forEach((t=>{if(t.level>=t.maxLevel)return;if("button-modifier-config"===t.id&&(this.state.multiButtonCount||1)<=1)return;const e=document.createElement("div");e.className="upgrade-item";const i=o.canPurchaseUpgrade(this.state,t.id);e.classList.toggle("can-purchase",i),e.innerHTML=`\n        <h3>${t.name} (Level ${t.level}/${t.maxLevel})</h3>\n        <p>${t.description}</p>\n        <p class="effect">${o.getUpgradeEffect(t)}</p>\n        <button class="upgrade-button" data-upgrade-id="${t.id}" ${i?"":"disabled"}>\n          Buy (${t.cost} CP)\n        </button>\n      `;const n=e.querySelector("button");n&&n.addEventListener("click",(()=>this.purchaseUpgrade(t.id))),this.upgradesContainer.appendChild(e)}))}purchaseUpgrade(t){if(!o.canPurchaseUpgrade(this.state,t))return;const e={...this.state};if(this.state=o.purchaseUpgrade(this.state,t),e.buttonSpeed!==this.state.buttonSpeed)for(const t of this.buttons.values())t.speed=this.state.buttonSpeed;this.updateDisplay(),this.renderUpgrades(),"multi-button"===t&&this.renderButtons(),"button-modifier-config"===t&&(this.setupButtonSlotConfigUI(),this.renderButtonSlotConfigUI()),this.saveGame(),this.checkAutoClickerActivation()}addPoints(t){this.state.points+=t,this.updateDisplay(),this.renderUpgrades()}createPointsPopup(t,e){const i=document.createElement("div");i.className="points-popup",i.textContent=`+${e}`,i.style.position="absolute",i.style.left=`${t.x}px`,i.style.top=`${t.y}px`,i.style.transform="translate(-50%, -50%)",i.style.pointerEvents="none",i.style.zIndex="110",this.container.appendChild(i),setTimeout((()=>i.remove()),1e3)}getRandomPosition(){const t=window.innerWidth-200-340,e=window.innerHeight-200;return{x:Math.random()*t+100,y:Math.random()*e+100}}updateDisplay(){this.pointsCounter.textContent=Math.floor(this.state.points).toString()}setupAutoSave(){setInterval((()=>this.saveGame()),1e4)}saveGame(){const t={...this.state,multiButtonCount:this.state.multiButtonCount||1,upgrades:this.state.upgrades};localStorage.setItem("clickDriftSave",JSON.stringify(t))}loadGame(){const t=localStorage.getItem("clickDriftSave");if(t){const e=JSON.parse(t),i={...o.initializeUpgrades(),...e.upgrades||{}};this.state={...this.state,...e,upgrades:i},this.updateDisplay()}}createAutoClickerMouse(){if(this.autoClickerMouseEl)return;const t=document.createElement("div");t.className="auto-clicker-mouse",t.style.position="absolute",t.style.width="32px",t.style.height="48px",t.style.zIndex="120",t.style.pointerEvents="none",t.style.background="none",t.innerHTML="";const e=document.createElement("img");e.src="/mouse.png",e.alt="Auto Clicker Mouse",e.style.width="100%",e.style.height="100%",e.style.display="block",t.appendChild(e),this.autoClickerMouseEl=t,this.container.appendChild(t)}moveAutoClickerMouseToButton(t){if(!this.autoClickerMouseEl)return;const e=this.container.querySelector(`button[data-id="${t}"]`);if(!e)return;const i=e.getBoundingClientRect(),o=i.left+i.width/2-16,n=i.top+i.height/2-24;this.autoClickerMouseEl.style.left=`${o}px`,this.autoClickerMouseEl.style.top=`${n}px`,this.autoClickerMouseEl.style.transition="left 0.5s cubic-bezier(0.22, 1, 0.36, 1), top 0.5s cubic-bezier(0.22, 1, 0.36, 1)"}startAutoClicker(){if(this.autoClickerActive)return;this.autoClickerActive=!0,this.createAutoClickerMouse();let t=0;const e=()=>Array.from(this.buttons.keys()),i=t=>{if(!this.autoClickerMouseEl)return;const e=this.container.querySelector(`button[data-id="${t}"]`);if(!e)return;const i=e.getBoundingClientRect(),o=i.left+i.width/2-16,n=i.top+i.height/2-24;this.autoClickerMouseEl.style.left=`${o}px`,this.autoClickerMouseEl.style.top=`${n}px`,this.autoClickerMouseEl.style.transition="left 0.5s cubic-bezier(0.22, 1, 0.36, 1), top 0.5s cubic-bezier(0.22, 1, 0.36, 1)"};this.autoClickerInterval=setInterval((()=>{const o=e();if(0===o.length)return;t=(t+1)%o.length;const n=o[t];i(n),setTimeout((()=>{if(!this.autoClickerActive)return;const t=this.container.querySelector(`button[data-id="${n}"]`);t&&t.click()}),500)}),2e3/Math.max(1,this.state.autoClickerRate||1))}stopAutoClicker(){this.autoClickerActive=!1,this.autoClickerInterval&&(clearInterval(this.autoClickerInterval),this.autoClickerInterval=null),this.autoClickerMouseEl&&(this.autoClickerMouseEl.remove(),this.autoClickerMouseEl=null)}checkAutoClickerActivation(){this.state.autoClickerRate>0?this.startAutoClicker():this.stopAutoClicker()}setupDeleteSaveButton(){const t=document.getElementById("delete-save-btn");t&&t.addEventListener("click",(()=>{confirm("Are you sure you want to delete your save? This cannot be undone.")&&(localStorage.removeItem("clickDriftSave"),this.resetGame())}))}resetGame(){for(const t of Array.from(this.buttons.keys()))this.removeButton(t);this.state={points:0,clickMultiplier:1,autoClickerRate:0,buttonSpeed:1,upgrades:o.initializeUpgrades(),multiButtonCount:1,buttonSlots:[]},this.updateDisplay(),this.renderUpgrades(),this.renderButtons(),this.checkAutoClickerActivation(),this.saveGame()}renderButtonSlotConfigUI(){let t=document.getElementById("button-slot-config");t&&t.remove(),t=document.createElement("div"),t.id="button-slot-config",t.className="window",t.style.position="fixed",t.style.bottom="80px",t.style.left="24px",t.style.minWidth="260px",t.style.zIndex="301",t.style.pointerEvents="auto";const o=document.createElement("div");o.className="title-bar";const n=document.createElement("div");n.className="title-bar-text",n.textContent="Configure Button Modifiers",o.appendChild(n),t.appendChild(o);const s=document.createElement("div");s.className="window-body",s.style.padding="12px";const a=this.state.multiButtonCount||1;for(let t=0;t<a;t++){const o=this.state.buttonSlots?.[t]||{variant:e.Normal,modifiers:[]},n=document.createElement("div");if(n.style.marginBottom="12px",n.innerHTML=`<b>Button #${t+1}</b> `,t>0){const e=document.createElement("select");e.className="form-control",e.multiple=!1;for(const t of Object.values(i)){const i=document.createElement("option");i.value=t,i.textContent=t.charAt(0).toUpperCase()+t.slice(1),1===o.modifiers?.length&&o.modifiers[0]===t&&(i.selected=!0),e.appendChild(i)}e.addEventListener("change",(e=>{const i=e.target.value;this.setButtonSlotConfig(t,{...o,modifiers:[i]})})),n.appendChild(e)}else n.appendChild(document.createTextNode("(No modifiers)"));s.appendChild(n)}t.appendChild(s),document.body.appendChild(t)}setButtonSlotConfig(t,e){this.state.buttonSlots||(this.state.buttonSlots=[]),this.state.buttonSlots[t]=e,this.saveGame(),this.renderButtons(),this.renderButtonSlotConfigUI()}setupButtonSlotConfigUI(){const t=this.state.upgrades["button-modifier-config"];if(!t||t.level<1)return;let e=document.getElementById("configure-buttons-btn");e||(e=document.createElement("button"),e.id="configure-buttons-btn",e.textContent="Configure Buttons",e.className="btn btn-default",e.style.position="fixed",e.style.bottom="48px",e.style.left="24px",e.style.zIndex="302",e.addEventListener("click",(()=>{const t=document.getElementById("button-slot-config");t?t.remove():this.renderButtonSlotConfigUI()})),document.body.appendChild(e))}createExplosionEffect(t,e){const i=this.container.querySelector(`button[data-id="${t}"]`);if(!i)return;const o=document.createElement("div");o.className=`explosion-effect explosion-${e}`,o.style.position="absolute",o.style.left=i.style.left,o.style.top=i.style.top,o.style.width=i.style.width,o.style.height=i.style.height,o.style.zIndex="200",this.container.appendChild(o),setTimeout((()=>o.remove()),600)}}document.addEventListener("DOMContentLoaded",(()=>{new n}));const s=document.getElementById("movingButton");let a,r=!1,l=1,c=1e3;s.addEventListener("click",(function(){if(r)return;r=!0,s.style.animationDuration=`${l}s`,s.classList.remove("color-animation"),s.offsetWidth,s.classList.add("color-animation");const t=window.innerWidth-s.clientWidth,e=window.innerHeight-s.clientHeight,i=Math.floor(Math.random()*t),o=Math.floor(Math.random()*e);s.style.transform=`translate(${i}px, ${o}px)`,s.style.transitionDuration=`${l}s`,s.style.animationDuration="0.25s",a=setInterval((()=>{!function(t){const e=document.createElement("div");e.className="trail";const i=t.getBoundingClientRect();e.style.left=`${i.left}px`,e.style.top=`${i.top}px`,e.style.width=`${i.width}px`,e.style.height=`${i.height}px`,e.style.backgroundColor=window.getComputedStyle(t).backgroundColor,document.body.appendChild(e),requestAnimationFrame((()=>{e.style.opacity="0"})),setTimeout((()=>{e.remove()}),1e3)}(s)}),.1),s.addEventListener("transitionend",(()=>{r=!1,clearInterval(a)}),{once:!0})}));const u=document.getElementById("autoclickerButton");let d,h=!1;function p(){d=setInterval((()=>{s.click(),c>100&&(c-=50,l=c/1e3,clearInterval(d),p())}),c)}u.addEventListener("click",(function(){h?(h=!1,u.textContent="Autoclicker",clearInterval(d),c=1e3,l=1):(h=!0,u.textContent="Stop Autoclicker",p())}))})();